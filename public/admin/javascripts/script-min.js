function checkIfErrorExists(e){if(activeErrorList.length>0)return-1!==$.inArray(e,activeErrorList)}function handleError(e){checkIfErrorExists(e)||(activeErrorList.push(e),errorsExist=!0)}function removeError(e){if(checkIfErrorExists(e)){var i=$.inArray(e,activeErrorList);activeErrorList.splice(i,1),0==activeErrorList.length&&(errorsExist=!1)}}function prepareErrorList(){var e="",i;return $.each(activeErrorList,function(r,a){i=errorList[a],console.log("string: ",i),e=e+"<li>"+i+"</li>"}),e}function collectErrors(){$(".notempty").each(function(e,i){var r="err_"+i.id;r=r.replace(/-/g,"_"),i.value?removeError(r):(handleError(r),errorsExist=!0)}),console.log(activeErrorList)}function closeMsg(){msgList.forEach(function(e){$("msg-content").removeClass(e)}),$(".msg-wrapper").fadeOut(300)}function showMsg(e,i){var r=$(".msg-content"),a;switch(r.addClass(e),e){case"warning":a="Warnung";break;case"info":a="Information";break;case"alert":a="Achtung"}$(".msg-title").html(a),$(".msg-message").html(i),$(".msg-wrapper").fadeIn(300)}function saveAll(e){if(collectErrors(),errorsExist){showMsg("warning",prepareErrorList())}else{var i=$(e).data("projectid"),r=$("#project-name-input"),a=r.val(),t=r.data("currentName"),n=$("#title").val(),s=$("#description").val(),o=$("input[name=layout]:checked").val(),c=$("#menuname").val(),l=$("#visible-check").is(":checked"),d=$(".loading-wrapper"),m=$(".loading-screen"),u={id:i,title:n,description:s,layout:o,menuname:c,visible:l};a!=t&&(u.name=a,u.namechanged=!0),d.addClass("show"),d.fadeTo(300,1,function(e){$.post("/admin/save_all",u,function(e){"changed"==e&&$(".li-wrapper.active > a > span").text(a),m.addClass("success").delay(100).queue(function(e){d.fadeTo(1800,0,function(){$(this).removeClass("show")}),$(this).delay(1900).queue(function(e){$(this).removeClass("success"),e()}),e()})})})}}function reloadAll(){location.reload()}function successAnimation(e){e.addClass("updated").delay(1e3).queue(function(e){$(this).removeClass("updated"),e()})}function updateImage(e,i,r){var a=r.length+1,t=i.substring(a);projectId=$(".current-id").data("id");var n,s=$(e).closest(".img-li");"visibility"==r&&(n=$(e)[0].checked);var o={imgid:t,proid:projectId,vistatus:n};$.post("/admin/update_image/"+r,o,function(e){"success"==e&&("delete"==r?s.hide():successAnimation(s))})}function imageView(e,i){var r=$(e).parent(),a=r.attr("id");if(currentImgId!==a){currentImgId=a;var t="#imgList_"+i,n=$(t),s=$(".img-li.active"),o=s.find(".img-form").first();$activeNameInput=o.find(".form-img--name:first"),$activeDescInput=o.find(".form-img--desc:first"),n.addClass("big-view"),$activeNameInput.val($activeNameInput.data("imgname")),$activeDescInput.val($activeDescInput.data("imgdesc")),s.removeClass("active"),r.addClass("active")}}function saveImgEdit(e,i){var r=$(".img-li.active"),a=r.find(".form-img--name:first"),t=a.val(),n=r.find(".form-img--desc:first"),s=n.val(),o=r.find(".img-name-p"),c={project_id:e,image_id:i,name:t,desc:s};""!==t?$.post("/admin/edit_image",c,function(e){"success"==e&&(a.data("imgname",t),n.data("imgdesc",s),o.text(t),successAnimation(r))}):alert("Name darf nicht leer sein.")}function cancelImgEdit(){var e=$(".img-li.active"),i=e.find(".form-img--name:first"),r=e.find(".form-img--desc:first");i.val(i.data("imgname")),r.val(r.data("imgdesc"))}function closeBigView(){var e=$(".img-li.active");cancelImgEdit(),e.removeClass("active"),$(".big-view").removeClass("big-view"),currentImgId=""}function isValid(e){return/^\w+$/.test(e)}function checkIfValid(e){var i=$(e),r=i.val();i.removeClass("notunique"),isValid(r)?$(".invalid").removeClass("invalid"):i.addClass("invalid"),delay(function(){checkNameIsUnique(e)},300)}function checkNameIsUnique(e){var i=$(e),r=i.val(),a=i.data("projectid"),t={name:r,id:a};""!=r?isValid(r)?($(".invalid").removeClass("invalid"),removeError("err_urlNameInvalid"),$.post("/admin/check_name",t,function(e){"error"!=e&&("not_unique"==e?(i.addClass("notunique"),handleError("err_urlNameNotUnique")):(removeError("err_urlNameNotUnique"),i.removeClass("notunique")))})):(console.log("name not valid"),i.addClass("invalid"),i.removeClass("notunique"),handleError("err_urlNameInvalid")):console.log("cannot be empty!")}var projectId,currentImageDesc,$currentImageNameInput,$activeNameInput,currentImgId,errorsExist=!1,activeErrorList=[],delay=function(){var e=0;return function(i,r){clearTimeout(e),e=setTimeout(i,r)}}(),errorList={err_project_name_input:"Name darf nicht leer sein.",err_title:"Titel darf nicht leer sein.",err_urlNameInvalid:"Der URL-Name darf nicht leer sein. Der URL-Name darf keine Sonderzeichen oder Umlaute enthalten.",err_urlNameNotUnique:"Der URL-Name existiert bereits. Vielleicht auch im Mistk√ºbel."},msgList=["warning","info","alert"];$(".folder").on("click",function(e){$obj=$(this).closest(".li-container"),$obj.toggleClass("unfold");var i=$obj.hasClass("unfold"),r=$obj.attr("id"),a={id:r,unfold:i};$.post("/admin/togglefold",a,function(e){console.log(e)})}),$(".project-form form").on("submit",function(e){e.preventDefault();var i=$("#project-name"),r=i.val(),a=i.data("whoid");""!==r&&void 0==a?$.post("/admin/create_project",{name:r},function(e){i.val("")}):""!==r&&void 0!==a&&$.post("/admin/create_sub_project",{name:r,parentId:a},function(e){console.log("success: ",e)})});