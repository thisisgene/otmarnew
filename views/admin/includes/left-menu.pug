- var linkClass = ''
- var currentProject
- var parentsList = new Array

mixin parseSubProjects(obj, parentName, parentId, pList)
  ul.unstyled.sub-list.sortable.connect-sortable
    each projectId in obj
      each project in projects

        if (project.id == projectId && !project.deleted)

          - project.parentsList = (pList?pList:[])
          - var parent = new Array

          - parent.name = parentName
          - parent.id = parentName + '12344'
          - project.parentsList.push({name: parentName, id: parentId})

          if (project._id == currentProjectId)
            - linkClass = 'active'
            - currentProject = project

          else
            - linkClass = ''

          li(id=project._id, class=project.unfold ? 'unfold' : '').li-container
            .li-wrapper(class=linkClass)
              .menu-link
                div(class=project.hasChildren ? 'folder' : 'nothing')
                a(href='/admin/project/' + project._id)
                  span.upper.small= project.name
              a(href='/admin/delete/' + project._id).delete
                img
            if (project.hasChildren)
              +parseSubProjects(project.childrenIds, project.name, project._id, project.parentsList)

.left-container
  .top-section
    h1.slim-title MENÃœPUNKTE
    .project-form
      form.form
        .form-item
          //label Neues Projekt erstellen
          .append.w100
            input(type='text', name='project', data-whoid=currentProjectId)#project-name
            button.button.outline Go

  .project-list
    a(href='/admin').list-start Start
    ul.unstyled.sortable.connect-sortable.project-ul

      each project in projects
        if (!project.deleted && !project.hasParent)
          // - linkClass = (project._id == currentProjectId ? 'active':'')
          if (project._id == currentProjectId)
            - linkClass = 'active'
            - currentProject = project
          else
            - linkClass = ''
          li(id=project._id, class=project.unfold ? 'unfold' : '').li-container
            .li-wrapper(class=linkClass)

              .menu-link
                div(class=project.hasChildren ? 'folder' : 'nothing')
                a(href='/admin/project/' + project._id)
                  span.upper.small= project.name
              a(href='/admin/delete/' + project._id).delete
                img
            if (project.hasChildren)
              +parseSubProjects(project.childrenIds, project.name, project._id)
